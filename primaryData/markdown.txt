@using  System.Data;
@using System;
@using System.Linq;
@using Stankins.Interfaces;
@using System.Collections.Generic;
@using RazorLight;
@using Stankins.Razor;

@inherits TemplatePage<IDataToSent>
@{

    var wordsTable = Model.FindAfterName("words").Value;
	var cardsTable = Model.FindAfterName("cards").Value;
    var nl = Environment.NewLine;



}


@functions{
class Card{
	public string name;
	public string ID;
	public string OwnerID;
	public List<Word> Words = new List<Word>();
 }
 class Word{
	public string name;
	public string cardsID;
	public string officialLink;
 }
}
@{
    var cardsList = new Dictionary<string, Card>();
    foreach (DataRow rowCard in cardsTable.Rows)
    {
        var t = new Card();
        t.ID = rowCard["ID"].ToString();
		t.name = rowCard["name"].ToString();
		t.OwnerID = rowCard["OwnerID"].ToString();
		cardsList.Add(t.ID,t);
        
	}
	foreach (DataRow rowWord in wordsTable.Rows)
    {
        var t = new Word();
        t.cardsID = rowWord["cardsID"].ToString();
		t.name = rowWord["name"].ToString();
		t.officialLink= rowWord["officialLink"].ToString();
		cardsList[t.cardsID].Words.Add(t);
        
	}
}

@{
    foreach(var card in cardsList){
		var nrWord=1;
		<text>## @card.Value.name</text> 
		@Raw(nl)
		foreach(var word in card.Value.Words){
			@(nrWord++)<text>. </text>@word.name  @Raw(word.officialLink) @Raw(nl)
		}
	}
}

<small>
    Autogenerated from <a href="https://azurestankins.azurewebsites.net/">Stankins</a> with the Razor .cshtml file @nameof(SenderTrelloTo) at @DateTime.Now.ToString("yyyy MMM dd HH:mm:ss")
</small>